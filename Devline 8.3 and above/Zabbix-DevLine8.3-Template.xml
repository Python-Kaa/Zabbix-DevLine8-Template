<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.4</version>
    <template_groups>
        <template_group>
            <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            <name>Templates</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>59d97b02f4974f8baaba574f7c6d5d75</uuid>
            <template>DevLine 8.3</template>
            <name>DevLine 8.3</name>
            <description>Если проверка web-сервисов на 80 порт проходит, а на другие нет - настраивать или отключать SELinux на сервере или прокси (откуда там у запросы будут идти)</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>56bdfbc69f1741f595b4e6cb3058efda</uuid>
                    <name>DevLine - Версия API</name>
                    <type>HTTP_AGENT</type>
                    <key>devline.server[api_ver]</key>
                    <delay>3h</delay>
                    <authtype>DIGEST</authtype>
                    <username>{$DEVLINE_LOGIN}</username>
                    <password>{$DEVLINE_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.version.value</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/rpc</url>
                    <status_codes/>
                    <post_type>JSON</post_type>
                    <posts>{
   &quot;method&quot; : &quot;get_version&quot;
}</posts>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <request_method>POST</request_method>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>44056cd8a4ec444cae1b687d7b7726a5</uuid>
                    <name>DevLine - Список камер</name>
                    <type>HTTP_AGENT</type>
                    <key>devline.server[camera.all]</key>
                    <delay>3h</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <authtype>DIGEST</authtype>
                    <username>{$DEVLINE_LOGIN}</username>
                    <password>{$DEVLINE_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>&quot;body&quot;</parameter>
                                <parameter>&quot;data&quot;</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/cameras</url>
                    <status_codes/>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b237b28bded74684bcc13c37498d97f7</uuid>
                    <name>DevLine - Состояние камер</name>
                    <type>HTTP_AGENT</type>
                    <key>devline.server[camera.state]</key>
                    <delay>5m</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <authtype>DIGEST</authtype>
                    <username>{$DEVLINE_LOGIN}</username>
                    <password>{$DEVLINE_PASSWORD}</password>
                    <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/rpc</url>
                    <status_codes/>
                    <post_type>JSON</post_type>
                    <posts>{
   &quot;method&quot; : &quot;monitoring.get_media_state&quot;,
   &quot;version&quot; : {$DEVLINE_API_VER}
}</posts>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <request_method>POST</request_method>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2024681a2ca844559508f0cd2a0b41ff</uuid>
                            <expression>find(/DevLine 8.3/devline.server[camera.state],,&quot;like&quot;,&quot;\&quot;message\&quot; : \&quot;forbidden\&quot;&quot;)=1</expression>
                            <name>DevLine - Forbidden</name>
                            <priority>HIGH</priority>
                            <description>Сервер вернул ошибку о том, что у пользователя недостаточно прав. Нужно проверить наличие права Администрирование -&gt; Просмотр мониторинга</description>
                        </trigger>
                        <trigger>
                            <uuid>15abcb1e1f384bd8b127c5be15246743</uuid>
                            <expression>last(/DevLine 8.3/devline.server[camera.state])=&quot;{\&quot;body\&quot;:\&quot;&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;401 - Unauthorized&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;H1&gt;401 - Unauthorized&lt;/H1&gt;&lt;P&gt;&lt;/P&gt;&lt;/BODY&gt;&lt;/HTML&gt;\&quot;}&quot;</expression>
                            <name>DevLine - User Unauthorized</name>
                            <priority>HIGH</priority>
                            <description>Сервер не нашел у себя пользователя с указанными именем и паролем</description>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>5ff8866bce324232ab829ea7c9a926e6</uuid>
                    <name>DevLine - Данные сервера</name>
                    <type>HTTP_AGENT</type>
                    <key>devline.server[features.all]</key>
                    <delay>3h</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <authtype>DIGEST</authtype>
                    <username>{$DEVLINE_LOGIN}</username>
                    <password>{$DEVLINE_PASSWORD}</password>
                    <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/rpc</url>
                    <status_codes/>
                    <post_type>JSON</post_type>
                    <posts>{
   &quot;method&quot; : &quot;get_server_info&quot;,
   &quot;version&quot; : {$DEVLINE_API_VER}
}</posts>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <request_method>POST</request_method>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1ce1b98e78e94f47890f9ef1a592cf4c</uuid>
                    <name>DevLine - Demo State</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.demo]</key>
                    <delay>0</delay>
                    <valuemap>
                        <name>DevLine Demo State</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.demo</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>false</parameter>
                                <parameter>0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>true</parameter>
                                <parameter>1</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>840c0b2e5ebb43b59639d8b223ae3677</uuid>
                    <name>DevLine - HTTP port</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.http]</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.network.ports.http</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4c72153cf2704c94982ef0f5034bf8a6</uuid>
                    <name>DevLine - Server ID</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.id]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.id</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>cf97cef6bb814d23b30f512af596d24c</uuid>
                            <expression>change(/DevLine 8.3/devline.server[features.id])=1</expression>
                            <name>Devline Server replaced</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>d783c741db11401eb08bff3a7726f14f</uuid>
                    <name>DevLine - Main port</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.main]</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.network.ports.main</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ffc9d64d1aaa41c3bdd0622a87aa8cb7</uuid>
                    <name>DevLine - Server Model</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.model]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.model</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>Software DVR</error_handler_params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>820099e7b56b4131b1c1886b2f180b01</uuid>
                    <name>DevLine - Server Name</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.name]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.name</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>9a44f51bfeec4b60b26a6be01eb66eb4</uuid>
                    <name>DevLine - Ping port</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.ping]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.network.ports.ping</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>742bc6572b5641dbb91bcf7bc3ba0d02</uuid>
                    <name>DevLine - RTSP port</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.rtsp]</key>
                    <delay>0</delay>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.network.ports.rtsp</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8338928e243e4a36b238ae60147d227b</uuid>
                    <name>DevLine - Server Target</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.target]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.target</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>85c0ea7cf3bd4747aecbcf10a578b612</uuid>
                    <name>DevLine - Server type</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.type]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.type</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e2e96253d45048868def6307ff86c84f</uuid>
                    <name>DevLine - Server Version</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[features.version]</key>
                    <delay>0</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.info.version.name</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>24h</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>devline.server[features.all]</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Application</tag>
                            <value>Inventory</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>3d2ea49cd42240e89f495e75987442a7</uuid>
                            <expression>last(/DevLine 8.3/devline.server[features.version],#2)&lt;&gt;last(/DevLine 8.3/devline.server[features.version])</expression>
                            <name>DevLine Version was changed</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>167f28f6acfd4af5826b2ca99a47ef19</uuid>
                    <name>DevLine - Хранилища</name>
                    <type>HTTP_AGENT</type>
                    <key>devline.server[storage.state]</key>
                    <delay>5m</delay>
                    <value_type>CHAR</value_type>
                    <trends>0</trends>
                    <authtype>DIGEST</authtype>
                    <username>{$DEVLINE_LOGIN}</username>
                    <password>{$DEVLINE_PASSWORD}</password>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.body.result.state</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>{&quot;storages&quot;:[</parameter>
                                <parameter>{&quot;data&quot;:[</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/rpc</url>
                    <status_codes/>
                    <post_type>JSON</post_type>
                    <posts>{
   &quot;method&quot; : &quot;monitoring.get_archive_state&quot;,
   &quot;version&quot; : {$DEVLINE_API_VER}
}</posts>
                    <headers>
                        <header>
                            <name>Accept</name>
                            <value>application/json</value>
                        </header>
                        <header>
                            <name>Content-Type</name>
                            <value>application/json</value>
                        </header>
                    </headers>
                    <request_method>POST</request_method>
                    <output_format>JSON</output_format>
                    <tags>
                        <tag>
                            <tag>Service</tag>
                            <value>DevLine</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>7249dc65b2ed4c3c9d27b44f94adca83</uuid>
                    <name>Camera discovery</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[camera.discovery]</key>
                    <delay>0</delay>
                    <lifetime>5d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>cc2b6c7008824c70a325eb27e123e211</uuid>
                            <name>Devline - {#NAME} Admin State</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.admin.state]</key>
                            <delay>0</delay>
                            <valuemap>
                                <name>Devline Camera Admin State</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.result.state.cameras.{#NUM}.enabled</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>945ba1ddd33742f782ef8d91dc851234</uuid>
                            <name>Devline - Camera {#NUM} Name</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.name]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <status>DISABLED</status>
                            <discover>NO_DISCOVER</discover>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data.[{#NUM}].name</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.all]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b930d120c2aa4ae8890b01f8f9270a4c</uuid>
                            <name>DevLine - Состояние камеры {#NAME}</name>
                            <type>HTTP_AGENT</type>
                            <key>devline.server[camera.{#NUM}.status]</key>
                            <delay>3h</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <authtype>DIGEST</authtype>
                            <username>{$DEVLINE_LOGIN}</username>
                            <password>{$DEVLINE_PASSWORD}</password>
                            <url>http://{HOST.CONN}:{$DEVLINE_HTTP_PORT}/rpc</url>
                            <post_type>JSON</post_type>
                            <posts>{
   &quot;method&quot; : &quot;get_camera_config&quot;,
   &quot;params&quot; : 
   {
      &quot;camera&quot; : &quot;{#NUM}&quot;
   },
   &quot;version&quot; : {$DEVLINE_API_VER}
}</posts>
                            <headers>
                                <header>
                                    <name>Accept</name>
                                    <value>application/json</value>
                                </header>
                                <header>
                                    <name>Content-Type</name>
                                    <value>application/json</value>
                                </header>
                            </headers>
                            <request_method>POST</request_method>
                            <tags>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1b3c4f58017f4089a687840c998ccde2</uuid>
                            <name>Devline - {#NAME} Stream1 Admin State</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream1.admin.state]</key>
                            <delay>0</delay>
                            <valuemap>
                                <name>Devline Camera Admin State</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.result.state.cameras.{#NUM}.streams.video.enabled</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 1</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a13d63b398b8436bb2a02b1c3af00f37</uuid>
                            <name>Devline - {#NAME} Stream1 Codec</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream1.codec]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result.config.video_streams.video.codec</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.{#NUM}.status]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 1</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>71f23980010b4bac990c5ab2f60122af</uuid>
                            <name>Devline - {#NAME} Stream1 Resolution</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream1.resolution]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result.config.video_streams.video.resolution</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>,</parameter>
                                        <parameter>x</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.{#NUM}.status]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 1</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f1784035957546c29404165dba179628</uuid>
                            <name>Devline - {#NAME} Stream1 Status</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream1.status]</key>
                            <delay>0</delay>
                            <valuemap>
                                <name>DevLine Stream Status</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.result.state.cameras.{#NUM}.streams.video.active</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 1</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ce7a04d657104dafa6af0fffc4569d46</uuid>
                            <name>Devline - {#NAME} Stream2 Admin State</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream2.admin.state]</key>
                            <delay>0</delay>
                            <valuemap>
                                <name>Devline Camera Admin State</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.result.state.cameras.{#NUM}.streams.video2.enabled</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 2</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>240711888ce344b0b8e7e83742be5a08</uuid>
                            <name>Devline - {#NAME} Stream2 Codec</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream2.codec]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result.config.video_streams.video2.codec</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.{#NUM}.status]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 2</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>f01deab162994c37887a7aca5f3cdaf2</uuid>
                            <name>Devline - {#NAME} Stream2 Resolution</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream2.resolution]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result.config.video_streams.video2.resolution</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>,</parameter>
                                        <parameter>x</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.{#NUM}.status]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 2</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>4dc152d3be78499a8a9a88538fc067ea</uuid>
                            <name>Devline - {#NAME} Stream2 Status</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.stream2.status]</key>
                            <delay>0</delay>
                            <valuemap>
                                <name>DevLine Stream Status</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.body.result.state.cameras.{#NUM}.streams.video2.active</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>true</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>false</parameter>
                                        <parameter>0</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Video</tag>
                                    <value>{#NAME} stream 2</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>5e94ce17951e4f21bf403359bb93fa08</uuid>
                            <name>Devline - {#NAME} IP</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[camera.{#NUM}.url]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.result.config.url</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>REGEX</type>
                                    <parameters>
                                        <parameter>([\S]+)([@])([\S]+)</parameter>
                                        <parameter>\3</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[camera.{#NUM}.status]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>7491c52cd09f4d0490bc857332bd4c66</uuid>
                            <expression>last(/DevLine 8.3/devline.server[camera.{#NUM}.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.status])=0 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.status])=0</expression>
                            <name>DevLine - {#NAME} Fail</name>
                            <opdata>Camera - {ITEM.LASTVALUE1}, Stream1 - {ITEM.LASTVALUE3}, Stream2 - {ITEM.LASTVALUE5}</opdata>
                            <priority>AVERAGE</priority>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>b80b52787ab04f8dac77b7cf5e27725a</uuid>
                            <expression>last(/DevLine 8.3/devline.server[camera.{#NUM}.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.status])=0</expression>
                            <name>DevLine - {#NAME} Stream1 Fail</name>
                            <opdata>{ITEM.LASTVALUE3}</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>DevLine - {#NAME} Fail</name>
                                    <expression>last(/DevLine 8.3/devline.server[camera.{#NUM}.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.status])=0 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.status])=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>602d6081ab454eb78b849851a7acfdb7</uuid>
                            <expression>last(/DevLine 8.3/devline.server[camera.{#NUM}.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.status])=0</expression>
                            <name>DevLine - {#NAME} Stream2 Fail</name>
                            <opdata>{ITEM.LASTVALUE3}</opdata>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>DevLine - {#NAME} Fail</name>
                                    <expression>last(/DevLine 8.3/devline.server[camera.{#NUM}.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream1.status])=0 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.admin.state])=1 and last(/DevLine 8.3/devline.server[camera.{#NUM}.stream2.status])=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Camera</tag>
                                    <value>{#NAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>devline.server[camera.all]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NUM}</lld_macro>
                            <path>$.uri</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>STR_REPLACE</type>
                            <parameters>
                                <parameter>/cameras/</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <uuid>c2f5f9aefa6f4a83a5490c8f1dc14904</uuid>
                    <name>Storage discovery</name>
                    <type>DEPENDENT</type>
                    <key>devline.server[storage.discovery]</key>
                    <delay>0</delay>
                    <lifetime>14d</lifetime>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>8c2944270e974b34bfebd518f05bb18e</uuid>
                            <name>Devline - Storage {#PATH} days count</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.days]</key>
                            <delay>0</delay>
                            <units>days</units>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].archive.dates_count</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>0</error_handler_params>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>35695a85bb094d17ad0c1eb8915d86d2</uuid>
                            <name>Devline - Storage {#PATH} free space</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.free_space]</key>
                            <delay>0</delay>
                            <units>b</units>
                            <description>Объем свободного место в хранилище</description>
                            <valuemap>
                                <name>DevLine Storage Availability</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].free_space</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>MULTIPLIER</type>
                                    <parameters>
                                        <parameter>1000000</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>9ac82f5124724a46bcb7c9fe4b947f54</uuid>
                            <name>Devline - Storage {#PATH} state</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.state]</key>
                            <delay>0</delay>
                            <description>Флаг доступности хранилища</description>
                            <valuemap>
                                <name>DevLine Storage Availability</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].available</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[true]</parameter>
                                        <parameter>1</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[false]</parameter>
                                        <parameter>2</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>dc3b6d9e82614b3e9345917fd52c9aac</uuid>
                                    <expression>last(/DevLine 8.3/devline.server[storage.{#PATH}.state])=0</expression>
                                    <name>Хранилище {#PATH} недоступно</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d48f838d1b894f0dabfe8baccfb6ad9b</uuid>
                            <name>Devline - Storage {#PATH} write datarate</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.write.datarate]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>b/s</units>
                            <description>Среднее за несколько последних секунд количество байт данных, поступающих на запись в хранилище</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].write.datarate</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>d5baf46290c347199ed2f46ea48b1726</uuid>
                            <name>Devline - Storage {#PATH} last error time</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.write.error]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <description>Время последней ошибки записи в хранилище в формате [год, месяц, день, час, минута, секунда, миллисекунда]
Если элемент не обнаруживается, считаем, что всё хорошо</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].last_error_time</parameter>
                                    </parameters>
                                    <error_handler>CUSTOM_VALUE</error_handler>
                                    <error_handler_params>-</error_handler_params>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>JAVASCRIPT</type>
                                    <parameters>
                                        <parameter>if (value == &quot;-&quot;){
   return &quot;OK&quot;;
}

date = value.split(',');

for (i = 0; i &lt; date.length; i++){
   if (date[i] &lt; 10){
      date[i] = &quot;0&quot; + date[i];
   }
}

return date[3] + &quot;:&quot; + date[4] + &quot;:&quot; + date[5] + &quot;.&quot; + date[6] + &quot; &quot; + date[2] + &quot;.&quot; + date[1] + &quot;.&quot; + date[0];</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>24h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>a2cf884c1f134133994937280beea8b7</uuid>
                                    <expression>find(/DevLine 8.3/devline.server[storage.{#PATH}.write.error],,,&quot;OK&quot;)=0</expression>
                                    <name>Ошибка в хранилище {#PATH} (eq)</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>f2e8c1963e934002b0a880b27b6a6b05</uuid>
                                    <expression>find(/DevLine 8.3/devline.server[storage.{#PATH}.write.error],,&quot;like&quot;,&quot;OK&quot;)=0</expression>
                                    <name>Ошибка в хранилище {#PATH} (like)</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <uuid>8a93413737da40cc8020e8646b2e4399</uuid>
                                    <expression>find(/DevLine 8.3/devline.server[storage.{#PATH}.write.error],,&quot;ne&quot;,&quot;OK&quot;)=1</expression>
                                    <name>Ошибка в хранилище {#PATH} (ne)</name>
                                    <priority>HIGH</priority>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>8abd507fa43d4ab1a011843f9469dfee</uuid>
                            <name>Devline - Storage {#PATH} write queue</name>
                            <type>DEPENDENT</type>
                            <key>devline.server[storage.{#PATH}.write.queue]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <units>b</units>
                            <description>Максимальное за несколько последних секунд относительное значение размера очереди записи хранилища от максимально возможного</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.data[?(@.path == &quot;{#PATH}&quot;)].write.queue_size</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>[</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                                <step>
                                    <type>STR_REPLACE</type>
                                    <parameters>
                                        <parameter>]</parameter>
                                        <parameter/>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>devline.server[storage.state]</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>Application</tag>
                                    <value>Storage</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>DevLine</value>
                                </tag>
                                <tag>
                                    <tag>Storage</tag>
                                    <value>{#PATH}</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>devline.server[storage.state]</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#PATH}</lld_macro>
                            <path>$.path</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$DEVLINE_API_VER}</macro>
                    <value>82</value>
                    <description>На момент написания шаблона актуальная - это 82 версия. Но может быть другой</description>
                </macro>
                <macro>
                    <macro>{$DEVLINE_HTTP_PORT}</macro>
                    <value>9786</value>
                    <description>Порт для HTTP-запросов DevLine. По умолчанию - 9786 порт</description>
                </macro>
                <macro>
                    <macro>{$DEVLINE_LOGIN}</macro>
                    <value>admin</value>
                </macro>
                <macro>
                    <macro>{$DEVLINE_PASSWORD}</macro>
                    <type>SECRET_TEXT</type>
                </macro>
            </macros>
            <valuemaps>
                <valuemap>
                    <uuid>30d519a6f26a47c38a2cdb1c9e250689</uuid>
                    <name>Devline Camera Admin State</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Enabled</newvalue>
                        </mapping>
                        <mapping>
                            <value>0</value>
                            <newvalue>Off</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>a5ad31ac35ee47d2b09f0ced233ffaef</uuid>
                    <name>DevLine Demo State</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Demo</newvalue>
                        </mapping>
                        <mapping>
                            <value>0</value>
                            <newvalue>Commercial</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>8df61fcbd2374787b93c7fd7acbf6700</uuid>
                    <name>DevLine Storage Availability</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>Available</newvalue>
                        </mapping>
                        <mapping>
                            <value>0</value>
                            <newvalue>Fail</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
                <valuemap>
                    <uuid>f7b6fdaee6d946d8b4098136598ace7f</uuid>
                    <name>DevLine Stream Status</name>
                    <mappings>
                        <mapping>
                            <value>1</value>
                            <newvalue>OK</newvalue>
                        </mapping>
                        <mapping>
                            <value>0</value>
                            <newvalue>Fail</newvalue>
                        </mapping>
                    </mappings>
                </valuemap>
            </valuemaps>
        </template>
    </templates>
</zabbix_export>
